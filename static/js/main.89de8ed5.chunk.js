(this["webpackJsonporca-test-task"]=this["webpackJsonporca-test-task"]||[]).push([[0],{1550:function(e,t,s){"use strict";s.r(t);var a=s(0),c=s.n(a),r=s(22),n=s.n(r),i=s(11),o=s(21),l=s(8),b=s(44),d=s(50);const j=console.error,u=(...e)=>{j(e.join(" "))},O=(e,t)=>(...s)=>{const a=t(...s);return console.log("Request",e,"args",s,"result",a),a};var h=s(14),p=s(17);const y=Object(l.b)("tasks/set"),k=Object(l.b)("task/create"),f=Object(l.b)("tasks/fetch"),m=Object(l.b)("tasks/set/found"),g=Object(l.b)("tasks/reset/found");var x=Object(l.c)({tasksList:[],foundTasksList:[]},(e=>{e.addCase(y,((e,{payload:t})=>({...e,tasksList:t}))).addCase(m,((e,{payload:t})=>({...e,foundTasksList:t}))).addCase(g,(e=>({...e,foundTasksList:[]})))}));const T=(...e)=>[...new Set(e)],C=Object(l.b)("app/mode"),v=Object(l.b)("app/searchItems"),w=Object(l.b)("subTasks/fetch"),S=Object(l.b)("subTasks/set"),I=Object(l.b)("subTasks/set/found"),E=Object(l.b)("subTask/reset/found"),L=Object(l.b)("subTask/delete"),N=Object(l.b)("subTask/delete/success"),B=Object(l.b)("subTask/search:byLabel");var R=Object(l.c)({allSubTasks:{},foundSubTasksList:[],filters:[]},(e=>{e.addCase(S,((e,{payload:t})=>({...e,allSubTasks:{...e.allSubTasks,[t.taskId]:t.subTasks}}))).addCase(I,((e,{payload:t})=>({...e,foundSubTasksList:t}))).addCase(E,(e=>({...e,foundSubTasksList:[]}))).addCase(B,((e,{payload:t})=>({...e,filters:T(...e.filters,t)}))).addCase(C,((e,{payload:t})=>({...e,filters:t?e.filters:[],allSubTasks:t?e.allSubTasks:{}})))}));var M=Object(l.c)({isSearchMode:!1,searchQuery:""},(e=>{e.addCase(B,(e=>({...e,isSearchMode:!0,searchQuery:""}))).addCase(C,((e,{payload:t})=>({...e,isSearchMode:t,searchQuery:t?e.searchQuery:""}))).addCase(v,((e,{payload:t})=>({...e,searchQuery:t})))}));const A=Object(h.a)();var P=Object(p.b)({router:Object(o.b)(A),tasks:x,subTasks:R,app:M}),q=s(4),_=s(20),F=s.n(_);class Q{constructor(e){this.key=null,this.key=e,localStorage.getItem(this.key)||localStorage.setItem(this.key,JSON.stringify([]))}get(){try{return JSON.parse(localStorage.getItem(this.key))}catch{return null}}set(e){localStorage.setItem(this.key,JSON.stringify(e))}}var D={tasks:new Q("tasks"),subTasks:new Q("subTasks")},J=e=>(...t)=>new Promise((s=>setTimeout((()=>s(e(...t))),1500)));const $=Array.from({length:10}).map((()=>F.a.lorem.word())),z=(e,t)=>Math.floor(Math.random()*(t-e+1))+e;var U=J((({title:e})=>{const t=D.tasks.get(),s=D.subTasks.get(),a={id:F.a.datatype.uuid(),createTime:Date.now(),title:e||F.a.lorem.sentence()},c=Array.from({length:z(1,10)}).map((()=>({id:F.a.datatype.uuid(),taskId:a.id,title:F.a.lorem.sentence(),labels:[...new Set(Array.from({length:z(1,5)}).map((()=>$[z(0,9)])))]})));return D.tasks.set([...t,a]),D.subTasks.set([...s,...c]),a})),V=J((()=>D.tasks.get())),W=J(O("deleteTask",(e=>{const t=D.tasks.get(),s=t.some((t=>t.id===e));if(!s)throw new Error(`Task ${e} wasn't found`);return D.tasks.set([...t.filter((t=>t.id!==e))]),s}))),Y=J(O("findTasks",(e=>{const t=D.tasks.get(),s=e.toLowerCase();return t.filter((e=>e.title.toLowerCase().includes(s)))}))),G=s(24);const H=e=>e.app.isSearchMode,K=e=>e.app.searchQuery,X=e=>e.subTasks.foundSubTasksList,Z=e=>e.subTasks.filters,ee=(e,t)=>e.subTasks.allSubTasks[t]||[],te=e=>Object(G.a)(H,(e=>Object(G.a)(X,(t=>t.filter((t=>t.taskId===e)))))(e),(t=>ee(t,e)),((e,t,s)=>e?t:s));function*se(){const e=yield Object(q.b)(V);yield Object(q.d)(y(e))}function*ae(){const e=yield Object(q.e)(K);if(e){const t=yield Object(q.b)(Y,e);yield Object(q.d)(m(t))}}function*ce({payload:e}){yield Object(q.b)(U,e),yield Object(q.b)(se)}function*re({payload:e}){try{yield Object(q.b)(W,e);(yield Object(q.e)(H))&&(yield Object(q.c)(ae)),yield Object(q.c)(se)}catch(t){u("Delete task failed:",t)}}function*ne({payload:e}){const{taskId:t,id:s}=e;((e,t)=>!t.length||1===t.length&&t.some((({id:t})=>t===e)))(s,yield Object(q.e)(ee,t))&&(yield Object(q.b)(re,{payload:t}))}function*ie(){yield Object(q.g)(f.type,se),yield Object(q.f)(k.type,ce),yield Object(q.g)(v.type,ae),yield Object(q.f)(N.type,ne)}var oe=J(O("deleteSubTask",(e=>{const t=D.subTasks.get(),s=t.find((t=>t.id===e));if(s)return D.subTasks.set(t.filter((t=>t.id!==e))),s;throw new Error(`SubTask [${e}] not found`)}))),le=J((e=>D.subTasks.get().filter((t=>t.taskId===e)))),be=J(O("findSubTasks",(e=>{const t=D.subTasks.get(),s=e.toLowerCase();return t.filter((e=>e.title.toLowerCase().includes(s)))}))),de=J(O("findSubTasksByLabel",(e=>{const t=D.subTasks.get();return e.reduce(((e,t)=>{const s=t.toLowerCase();return e.filter((e=>e.labels.some((e=>e.toLowerCase()===s))))}),t)})));function*je({payload:e}){const t=yield Object(q.b)(le,e);yield Object(q.d)(S({taskId:e,subTasks:t}))}function*ue(){const e=yield Object(q.e)(K);if(e){const t=yield Object(q.b)(be,e);yield Object(q.d)(I(t))}}function*Oe(){const e=yield Object(q.e)(Z);if(e){const t=yield Object(q.b)(de,e);yield Object(q.d)(I(t))}}function*he({payload:e}){try{const{id:t,taskId:s}=e,a=yield Object(q.e)(H);yield Object(q.b)(oe,t),yield Object(q.d)(N(e)),a&&(yield Object(q.c)(Oe),yield Object(q.c)(ue)),yield Object(q.b)(je,{payload:s})}catch(t){u("Delete subTask request failed:",t)}}function*pe(){yield Object(q.f)(w.type,je),yield Object(q.f)(L.type,he),yield Object(q.g)(v.type,ue),yield Object(q.g)(B.type,Oe)}function*ye(){yield Object(q.b)(se)}const ke=Object(b.a)(A),fe=Object(d.a)({onError:(e,{sagaStack:t})=>{u("Something came up",e,t)}}),me=[...Object(l.d)({thunk:!1,serializableCheck:!1,immutableCheck:{warnAfter:300}}),ke,fe],ge=Object(l.a)({reducer:P,middleware:me,enhancers:[],preloadedState:{},devTools:{trace:!0}});fe.run((function*(){yield Object(q.g)("app/init",ye),yield Object(q.a)([ie(),pe()])})),window.store=ge;var xe=ge,Te=s(10);const Ce=()=>"/";var ve=s(9);const we=ve.b.div.withConfig({displayName:"BorderedCenterArea"})(["width:500px;margin:20px auto;padding:20px;max-width:100%;border:1px dashed #a5a2a2;"]);var Se=s(2);var Ie=({children:e})=>Object(Se.jsx)(we,{children:e}),Ee=s(6),Le=s.n(Ee);const Ne=ve.b.button.withConfig({displayName:"Wrapper"})(["padding:4px 6px;height:fit-content;border-radius:1em;background-color:#96fbe4;border:none;&.yellow-button{background-color:#ffe082;}&.purple-button{background-color:#9c9cc7;color:#fff;}"]);var Be=e=>Object(Se.jsx)(Ne,{...e});const Re={CREATE_TIME:"BY_CREATE_TIME",TITLE:"BY_TITLE"},Me=Object(ve.b)(Be).withConfig({displayName:"SortButton"})(["margin-right:5px;"]),Ae={[Re.CREATE_TIME]:"Sort by create-date",[Re.TITLE]:"Sort by title"};var Pe=({sortType:e,sortBy:t})=>{const s=Object(a.useCallback)((()=>t(e)),[t,e]);return Object(Se.jsx)(Me,{className:"yellow-button",onClick:s,children:Ae[e]})};const qe=ve.b.input.attrs({type:"text"}).withConfig({displayName:"Input"})(["border-radius:1em;border:1px solid #656565;padding:2px 5px;"]),_e=({value:e,placeholder:t,onValueChange:s})=>{const[c,r]=Object(a.useState)(e),n=Object(a.useCallback)((e=>{r(e.target.value),s(e.target.value)}),[s]);return Object(a.useEffect)((()=>r(e)),[e]),Object(Se.jsx)(qe,{placeholder:t,value:c,onChange:n})};_e.defaultProps={value:"",placeholder:""};var Fe=_e;var Qe=()=>Object(Se.jsx)("h1",{children:"Processes"});const De=ve.b.ul.withConfig({displayName:"ListContainter"})(["margin-left:10px;margin-bottom:5px;.item{margin-bottom:5px;}&.hidden{display:none;}"]),Je=({items:e,ItemComponent:t,className:s})=>Object(Se.jsx)(De,{className:s,children:e.map((e=>Object(Se.jsx)("li",{children:Object(Se.jsx)(t,{...e})},e.id)))});Je.defaultProps={className:""};var $e=Je;const ze=ve.b.input.attrs({type:"checkbox"}).withConfig({displayName:"Checkbox"})(["margin-right:5px;"]),Ue=({onCheck:e,isUncheckable:t})=>{const[s,c]=Object(a.useState)(!1),r=Object(a.useCallback)((()=>{s||e(),c((e=>!!t||!e))}),[e,s,t]);return Object(Se.jsx)(ze,{onChange:r,checked:s})};Ue.defaultProps={isUncheckable:!1};var Ve=Ue;var We=({children:e})=>{const t=Object(i.e)(K),s=new RegExp(`(${t})`,"gi"),a=e.split(s);return t?Object(Se.jsx)(Se.Fragment,{children:a.map(((e,t)=>{const a=s.test(e);return Object(Se.jsx)(c.a.Fragment,{children:a?Object(Se.jsx)("mark",{children:e}):e},t)}))}):e};const Ye=Object(ve.b)(Be).withConfig({displayName:"LabelStyled"})(["padding:0 5px;"]);var Ge=({label:e})=>{const t=Object(i.d)(),s=Object(a.useCallback)((()=>t(B(e))),[t,e]);return Object(Se.jsxs)(Ye,{className:"label purple-button",onClick:s,children:["#",e]})};var He=({onToggle:e,onTitle:t,offTitle:s})=>{const[c,r]=Object(a.useState)(!1),n=Object(a.useCallback)((()=>{r((e=>!e)),e(!c)}),[c,e]);return Object(Se.jsx)(Be,{onClick:n,children:c?t:s})};const Ke=ve.b.div.withConfig({displayName:"ButtonContainer"})(["margin:5px 0;"]);var Xe=({sortBy:e})=>Object(Se.jsx)(Ke,{children:Object.values(Re).map((t=>Object(Se.jsx)(Pe,{sortBy:e,sortType:t},t)))});const Ze=ve.b.ul.withConfig({displayName:"LabelsListContainer"})(["margin:3px 0 10px;& > li{display:inline-block;margin-right:5px;}"]),et=ve.b.li.withConfig({displayName:"LabelListItem"})(["display:inline-block;margin-right:5px;"]),tt=({labels:e})=>Object(Se.jsx)(Ze,{children:e.map((e=>Object(Se.jsx)(et,{children:Object(Se.jsx)(Ge,{label:e})},e)))});tt.defaultProps={labels:[]};var st=tt;const at=({id:e,title:t,labels:s,taskId:c})=>{const r=Object(i.d)(),n=Object(a.useCallback)((()=>r(L({id:e,taskId:c}))),[r,e,c]);return Object(Se.jsxs)("span",{children:[Object(Se.jsx)(Ve,{onCheck:n,isUncheckable:!0}),Object(Se.jsx)("span",{id:e,children:Object(Se.jsx)(We,{children:t})}),Object(Se.jsx)(st,{labels:s})]})};at.defaultProps={labels:[]};Le.a.string.isRequired,Le.a.string.isRequired,Le.a.string.isRequired,Le.a.arrayOf(Le.a.string);var ct=at;var rt=({taskId:e,isExpanded:t})=>{const s=Object(i.e)(H),c=((e,t)=>{const s=Object(a.useCallback)(e(...t),[e,...t]);return Object(i.e)(s)})(te,[e]),r=t||s&&c.length;return Object(Se.jsx)($e,{className:!r&&"hidden",items:c,ItemComponent:ct})};const nt=e=>{const t=new Date(e);return`${t.toLocaleDateString()} ${t.toLocaleTimeString()}`},it=ve.b.div.withConfig({displayName:"TaskWrapper"})(["display:flex;justify-content:space-between;margin:5px 0;"]),ot=ve.b.span.withConfig({displayName:"TaskName"})(["flex-basis:40%;max-width:40%;overflow:hidden;text-overflow:ellipsis;"]);Le.a.string.isRequired,Le.a.string.isRequired,Le.a.number.isRequired;var lt=({title:e,id:t,createTime:s})=>{const c=Object(i.e)(H),[r,n]=Object(a.useState)(!1),o=Object(i.d)(),l=Object(a.useCallback)((e=>{e&&o(w(t)),n(e)}),[t,o]);return Object(Se.jsxs)(Se.Fragment,{children:[Object(Se.jsxs)(it,{children:[Object(Se.jsx)(ot,{children:Object(Se.jsx)(We,{children:e})}),Object(Se.jsx)("span",{children:nt(s)}),!c&&Object(Se.jsx)(He,{onToggle:l,onTitle:"Collapse",offTitle:"Expand"})]}),Object(Se.jsx)(rt,{taskId:t,isExpanded:r})]})};const bt=Object(G.a)(H,(e=>e.tasks.tasksList),(e=>e.tasks.foundTasksList),X,((e,t,s,a)=>{return e?(c=a,r=s,t.filter((e=>((e,t)=>{return s=e,a="id",!!t.find((e=>e[a]===s[a]));var s,a})(e,r)||((e,t)=>e.some((e=>e.taskId===t)))(c,e.id)))):t;var c,r})),dt={[Re.CREATE_TIME]:(e,t)=>e.createTime-t.createTime,[Re.TITLE]:(e,t)=>e.title<t.title?-1:1};var jt=e=>{const[t,s]=Object(a.useState)(Re.CREATE_TIME);return{sortedItems:((e,t)=>{const s=[...e];return s.sort(dt[t]),s})(e,t),sortBy:s}};var ut=()=>{const e=Object(i.e)(bt),{sortedItems:t,sortBy:s}=jt(e);return Object(Se.jsxs)("section",{children:[Object(Se.jsx)(Xe,{sortBy:s}),Object(Se.jsx)($e,{items:t,ItemComponent:lt})]})};var Ot=()=>{const e=Object(i.e)(Z);return Object(Se.jsx)("div",{children:Object(Se.jsx)(st,{labels:e})})};const ht=ve.b.section.withConfig({displayName:"TaskFormContainer"})(["& button{margin-left:5px;}"]),pt=({title:e})=>{const[t,s]=Object(a.useState)(e),c=Object(i.d)(),r=Object(i.e)(H),n=Object(a.useCallback)((()=>{c(k({title:t})),s("")}),[t,c]),o=Object(a.useCallback)((()=>{r?s(""):c(v(t)),c(C(!r))}),[c,r,t]),l=Object(a.useCallback)((e=>{s(e),r&&c(v(e))}),[r,c]);return Object(Se.jsxs)(ht,{children:[Object(Se.jsx)(Fe,{value:t,placeholder:"task title",onValueChange:l}),!r&&Object(Se.jsx)(Be,{onClick:n,children:"Create"}),Object(Se.jsx)(Be,{onClick:o,children:r?"Exit Search":"Start Search"}),Object(Se.jsx)(Ot,{})]})};pt.defaultProps={title:""};var yt=pt;var kt=()=>Object(Se.jsxs)(Se.Fragment,{children:[Object(Se.jsx)(Qe,{}),Object(Se.jsxs)("main",{children:[Object(Se.jsx)(yt,{}),Object(Se.jsx)(ut,{})]})]});var ft=()=>Object(Se.jsx)(Ie,{children:Object(Se.jsx)(kt,{})}),mt=s(27);var gt=()=>Object(Se.jsxs)(Ie,{children:[Object(Se.jsx)("h1",{children:"Page not found"}),Object(Se.jsx)(mt.a,{to:Ce(),children:"Go to home"})]});var xt=()=>Object(Se.jsxs)(Te.c,{children:[Object(Se.jsx)(Te.a,{path:Ce(),component:ft}),Object(Se.jsx)(Te.a,{component:gt})]}),Tt=Object(ve.a)(["*{padding:0;margin:0;outline:none;&,&:before,&:after{box-sizing:border-box;}}body{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;font-family:'Helvetica',sans-serif;font-weight:400;font-size:14px;line-height:1.4;}a{text-decoration:none;&,&:hover{color:inherit;}}p{margin:0;}ul,ol{margin:0;list-style:none;}img{max-width:100%;}h1,h2,h3,h4,h5,h6{margin:0;}pre{margin:0;}#root{height:100vh;display:flex;flex-direction:column;}"]);var Ct=()=>(Object(a.useEffect)((()=>{xe.dispatch({type:"app/init"})}),[]),Object(Se.jsxs)(Se.Fragment,{children:[Object(Se.jsx)(Tt,{}),Object(Se.jsx)(i.a,{store:xe,children:Object(Se.jsx)(o.a,{history:A,children:Object(Se.jsx)(xt,{})})})]}));window.logError=alert,n.a.render(Object(Se.jsx)(c.a.StrictMode,{children:Object(Se.jsx)(Ct,{})}),document.getElementById("root"))}},[[1550,1,2]]]);
//# sourceMappingURL=main.89de8ed5.chunk.js.map