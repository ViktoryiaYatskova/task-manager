(this["webpackJsonporca-test-task"]=this["webpackJsonporca-test-task"]||[]).push([[0],{1549:function(e,t,a){"use strict";a.r(t);var s=a(0),i=a.n(s),r=a(22),n=a.n(r),c=a(13),o=a(21),l=a(14),d=a(43),b=a(49);const j=window.alert;var u=(...e)=>{j(e.join(" "))},h=a(12),O=a(17);const p=Object(l.b)("tasks/set"),m=Object(l.b)("task/create"),g=Object(l.b)("tasks/fetch"),x=Object(l.b)("subtasks/fetch"),k=Object(l.b)("subtasks/set"),y=Object(l.b)("subTask/delete"),f=Object(l.b)("subTask/delete/success");var T=Object(l.c)({tasksList:[],allSubTasks:{}},(e=>{e.addCase(p,((e,{payload:t})=>({...e,tasksList:t}))),e.addCase(k,((e,{payload:t})=>({...e,allSubTasks:{...e.allSubTasks,[t.taskId]:t.subTasks}})))}));const v=Object(h.a)();var C=Object(O.b)({router:Object(o.b)(v),tasks:T}),w=a(9),I=a(20),E=a.n(I);class S{constructor(e){this.key=null,this.key=e,localStorage.getItem(this.key)||localStorage.setItem(this.key,JSON.stringify([]))}get(){try{return JSON.parse(localStorage.getItem(this.key))}catch{return null}}set(e){localStorage.setItem(this.key,JSON.stringify(e))}}var N={tasks:new S("tasks"),subTasks:new S("subTasks")},B=e=>(...t)=>new Promise((a=>setTimeout((()=>a(e(...t))),1500)));const L=Array.from({length:10}).map((()=>E.a.lorem.word())),R=(e,t)=>Math.floor(Math.random()*(t-e+1))+e;var A=B((({title:e})=>{const t=N.tasks.get(),a=N.subTasks.get(),s={id:E.a.datatype.uuid(),createTime:Date.now(),title:e},i=Array.from({length:R(1,10)}).map((()=>({id:E.a.datatype.uuid(),taskId:s.id,title:E.a.lorem.sentence(),labels:[...new Set(Array.from({length:R(1,5)}).map((()=>L[R(0,9)])))]})));return N.tasks.set([...t,s]),N.subTasks.set([...a,...i]),s})),_=B((()=>N.tasks.get())),q=B((e=>{const t=N.tasks.get(),a=N.tasks.get().find((t=>t.id===e));if(!a)throw new Error(`Task ${e} wasn't found`);return N.tasks.set([...t.filter((t=>t.id!==e))]),a}));const M=e=>e.tasks.tasksList,D=(e,t)=>e.tasks.allSubTasks[t]||[];function*F(){const e=yield Object(w.b)(_);yield Object(w.c)(p(e))}function*P({payload:e}){yield Object(w.b)(A,e),yield Object(w.b)(F)}function*J({payload:e}){try{yield Object(w.b)(q,e),yield Object(w.b)(F)}catch(t){u("Delete task failed:",t)}}function*z({payload:e}){const{taskId:t,id:a}=e;((e,t)=>!t.length||1===t.length&&!!t.find((({id:t})=>t===e)))(a,yield Object(w.d)(D,t))&&(yield Object(w.b)(J,{payload:t}))}function*$(){yield Object(w.f)(g,F),yield Object(w.e)(m,P),yield Object(w.e)(f,z)}var Y=B((e=>{const t=N.subTasks.get(),a=t.find((t=>t.id===e));if(a)return N.subTasks.set(t.filter((t=>t.id!==e))),a;throw new Error(`SubTask [${e}] not found`)})),V=B((e=>N.subTasks.get().filter((t=>t.taskId===e))));function*W({payload:e}){const t=yield Object(w.b)(V,e);yield Object(w.c)(k({taskId:e,subTasks:t}))}function*G({payload:e}){try{const{id:t,taskId:a}=e;yield Object(w.b)(Y,t),yield Object(w.c)(f(e)),yield Object(w.b)(W,{payload:a})}catch(t){u("Delete subTask request failed:",t)}}function*H(){yield Object(w.e)(x,W),yield Object(w.e)(y,G)}function*K(){yield Object(w.b)(F)}const Q=Object(d.a)(v),U=Object(b.a)({onError:(e,{sagaStack:t})=>{u("Something came up",e,t)}}),X=[...Object(l.d)({thunk:!1,serializableCheck:!1,immutableCheck:{warnAfter:300}}),Q,U],Z=Object(l.a)({reducer:C,middleware:X,enhancers:[],preloadedState:{},devTools:{trace:!0}});U.run((function*(){yield Object(w.f)("app/init",K),yield Object(w.a)([$(),H()])}));var ee=Z,te=a(7);const ae=()=>"/";var se=a(8);const ie=se.b.div.withConfig({displayName:"BorderedCenterArea"})(["width:500px;margin:20px auto;padding:20px;max-width:100%;border:1px dashed #a5a2a2;"]);var re=a(2);var ne=({children:e})=>Object(re.jsx)(ie,{children:e}),ce=a(5),oe=a.n(ce);const le=se.b.button.withConfig({displayName:"Wrapper"})(["padding:4px 6px;border-radius:1em;background-color:#96fbe4;border:none;"]);var de=e=>Object(re.jsx)(le,{...e});const be={CREATE_TIME:"BY_CREATE_TIME",TITLE:"BY_TITLE"},je=Object(se.b)(de).withConfig({displayName:"SortButton"})(["&{background-color:#ffe082;margin-right:5px;}"]),ue={[be.CREATE_TIME]:"Sort by create-date",[be.TITLE]:"Sort by title"};var he=({sortType:e,sortBy:t})=>{const a=Object(s.useCallback)((()=>t(e)),[t,e]);return Object(re.jsx)(je,{onClick:a,children:ue[e]})};const Oe=se.b.input.attrs({type:"text"}).withConfig({displayName:"Input"})(["border-radius:1em;border:1px solid #656565;padding:2px 5px;"]),pe=({value:e,placeholder:t,onValueChange:a})=>{const[i,r]=Object(s.useState)(e),n=Object(s.useCallback)((e=>{r(e.target.value),a(e.target.value)}),[a]);return Object(s.useEffect)((()=>r(e)),[e]),Object(re.jsx)(Oe,{placeholder:t,value:i,onChange:n})};pe.defaultProps={value:"",placeholder:""};var me=pe;var ge=()=>Object(re.jsx)("h1",{children:"Processes"});const xe=se.b.ul.withConfig({displayName:"ListContainter"})(["margin-left:10px;margin-bottom:5px;.item{margin-bottom:5px;}"]);var ke=({items:e,ItemComponent:t})=>Object(re.jsx)(xe,{children:e.map((e=>Object(re.jsx)("li",{children:Object(re.jsx)(t,{...e})},e.id)))});const ye=se.b.li.withConfig({displayName:"Label"})(["display:inline-block;margin-right:5px;padding:0 5px;border-radius:1em;background-color:#9c9cc7;color:#fff;"]),fe=se.b.ul.withConfig({displayName:"LabelsList"})(["margin:3px 0 10px;"]),Te=se.b.input.attrs({type:"checkbox"}).withConfig({displayName:"RemoveButton"})(["margin-right:5px;"]),ve=({id:e,title:t,labels:a,taskId:i})=>{const r=Object(c.d)(),n=Object(s.useCallback)((()=>r(y({id:e,taskId:i}))),[r,e,i]);return Object(re.jsxs)(re.Fragment,{children:[Object(re.jsx)(Te,{onClick:n}),Object(re.jsx)("span",{id:e,children:t}),Object(re.jsx)(fe,{children:a.map((e=>Object(re.jsxs)(ye,{className:"label",children:["#",e]},e)))})]})};ve.defaultProps={labels:[]};oe.a.string.isRequired,oe.a.string.isRequired,oe.a.string.isRequired,oe.a.arrayOf(oe.a.string);var Ce=ve;var we=({taskId:e})=>{const t=Object(s.useCallback)((t=>D(t,e)),[e]),a=Object(c.e)(t);return Object(re.jsx)(ke,{items:a,ItemComponent:Ce})};const Ie=e=>{const t=new Date(e);return`${t.toLocaleDateString()} ${t.toLocaleTimeString()}`},Ee=se.b.div.withConfig({displayName:"TaskWrapper"})(["display:flex;justify-content:space-between;"]),Se=se.b.span.withConfig({displayName:"TaskName"})(["flex-basis:40%;max-width:40%;overflow:hidden;text-overflow:ellipsis;"]);oe.a.string.isRequired,oe.a.string.isRequired,oe.a.number.isRequired;var Ne=({title:e,id:t,createTime:a})=>{const i=Object(c.d)(),r=Object(s.useCallback)((()=>i(x(t))),[t,i]);return Object(re.jsxs)(re.Fragment,{children:[Object(re.jsxs)(Ee,{children:[Object(re.jsx)(Se,{children:e}),Object(re.jsx)("span",{children:Ie(a)}),Object(re.jsx)(de,{onClick:r,children:"Expand"})]}),Object(re.jsx)(we,{taskId:t})]})};const Be=se.b.div.withConfig({displayName:"ButtonContainer"})(["margin:5px 0;"]);var Le=({sortBy:e})=>Object(re.jsx)(Be,{children:Object.values(be).map((t=>Object(re.jsx)(he,{sortBy:e,sortType:t},t)))});const Re={[be.CREATE_TIME]:(e,t)=>e.createTime-t.createTime,[be.TITLE]:(e,t)=>e.title<t.title?-1:1};var Ae=e=>{const[t,a]=Object(s.useState)(be.BY_CREATE_DATE);return{sortedItems:((e,t)=>{const a=[...e];return a.sort(Re[t]),a})(e,t),sortBy:a}};var _e=()=>{const e=Object(c.e)(M),{sortedItems:t,sortBy:a}=Ae(e);return Object(re.jsxs)(re.Fragment,{children:[Object(re.jsx)(Le,{sortBy:a}),Object(re.jsx)(ke,{items:t,ItemComponent:Ne})]})};const qe=se.b.div.withConfig({displayName:"TaskFormContainer"})(["& input{margin-right:5px;}"]),Me=({title:e})=>{const[t,a]=Object(s.useState)(e),i=Object(c.d)(),r=Object(s.useCallback)((()=>{i(m({title:t})),a("")}),[t,i]);return Object(re.jsxs)(qe,{children:[Object(re.jsx)(me,{value:t,placeholder:"task title",onValueChange:a}),Object(re.jsx)(de,{onClick:r,children:"Create"})]})};Me.defaultProps={title:""};var De=Me;var Fe=()=>Object(re.jsxs)(re.Fragment,{children:[Object(re.jsx)(ge,{}),Object(re.jsxs)("main",{children:[Object(re.jsx)(De,{}),Object(re.jsx)(_e,{})]})]});var Pe=()=>Object(re.jsx)(ne,{children:Object(re.jsx)(Fe,{})}),Je=a(26);var ze=()=>Object(re.jsxs)(ne,{children:[Object(re.jsx)("h1",{children:"Page not found"}),Object(re.jsx)(Je.a,{to:ae(),children:"Go to home"})]});var $e=()=>Object(re.jsxs)(te.c,{children:[Object(re.jsx)(te.a,{path:ae(),component:Pe}),Object(re.jsx)(te.a,{component:ze})]}),Ye=Object(se.a)(["*{padding:0;margin:0;outline:none;&,&:before,&:after{box-sizing:border-box;}}body{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;font-family:'Helvetica',sans-serif;font-weight:400;font-size:14px;line-height:1.4;}a{text-decoration:none;&,&:hover{color:inherit;}}p{margin:0;}ul,ol{margin:0;list-style:none;}img{max-width:100%;}h1,h2,h3,h4,h5,h6{margin:0;}pre{margin:0;}#root{height:100vh;display:flex;flex-direction:column;}"]);var Ve=()=>(Object(s.useEffect)((()=>{ee.dispatch({type:"app/init"})}),[]),Object(re.jsxs)(re.Fragment,{children:[Object(re.jsx)(Ye,{}),Object(re.jsx)(c.a,{store:ee,children:Object(re.jsx)(o.a,{history:v,children:Object(re.jsx)($e,{})})})]}));window.logError=alert,n.a.render(Object(re.jsx)(i.a.StrictMode,{children:Object(re.jsx)(Ve,{})}),document.getElementById("root"))}},[[1549,1,2]]]);
//# sourceMappingURL=main.ffdaa7b6.chunk.js.map